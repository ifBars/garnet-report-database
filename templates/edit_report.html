{% extends 'base.html' %}

{% block content %}
<h1>{{ 'Edit Report' if report else 'Add New Report' }}</h1>
<form method="POST">
    <div class="mb-3">
        <label for="date_time" class="form-label">Date/Time</label>
        <input type="datetime-local" class="form-control" id="date_time" name="date_time" required value="{{ report.date_time.strftime('%Y-%m-%dT%H:%M:%S') if report else '' }}">
    </div>
    <div class="mb-3">
        <label for="reporter" class="form-label">Reporter</label>
        <input type="text" class="form-control" id="reporter" name="reporter" required value="{{ report.reporter if report else '' }}">
    </div>
    <div class="mb-3">
        <label for="reportee" class="form-label">Reportee</label>
        <input type="text" class="form-control" id="reportee" name="reportee" required value="{{ report.reportee if report else '' }}">
    </div>
    <div class="mb-3">
        <label for="report_reason" class="form-label">Report Reason</label>
        <select class="form-select" id="report_reason" name="report_reason" required onchange="toggleOtherField()">
            <option value="" disabled>Select a reason</option>
            <option value="RDM" {% if report and report.report_reason == 'RDM' %}selected{% endif %}>RDM</option>
            <option value="MassRDM" {% if report and report.report_reason == 'MassRDM' %}selected{% endif %}>MassRDM</option>
            <option value="Propblock" {% if report and report.report_reason == 'Propblock' %}selected{% endif %}>Propblock</option>
            <option value="PB Spawn" {% if report and report.report_reason == 'PB Spawn' %}selected{% endif %}>PB Spawn</option>
            <option value="Racism" {% if report and report.report_reason == 'Racism' %}selected{% endif %}>Racism</option>
            <option value="NLR" {% if report and report.report_reason == 'NLR' %}selected{% endif %}>NLR</option>
            <option value="FailRP" {% if report and report.report_reason == 'FailRP' %}selected{% endif %}>FailRP</option>
            <option value="FailBase" {% if report and report.report_reason == 'FailBase' %}selected{% endif %}>FailBase</option>
            <option value="Other" {% if report and report.report_reason == 'Other' %}selected{% endif %}>Other</option>
        </select>
        <input type="text" class="form-control mt-2 {% if not report or report.report_reason != 'Other' %}d-none{% endif %}" id="other_reason" name="other_reason" placeholder="Please specify" value="{{ report.other_reason if report and report.report_reason == 'Other' else '' }}" />
    </div>
    <div class="mb-3">
        <label for="evidence" class="form-label">Evidence (Comma-separated file paths)</label>
        <textarea class="form-control" id="evidence" name="evidence" rows="3" required>{{ report.evidence if report else '' }}</textarea>
    </div>
    <div class="mb-3">
        <label for="punishment" class="form-label">Punishment</label>
        <input type="text" class="form-control" id="punishment" name="punishment" required value="{{ report.punishment if report else '' }}">
    </div>
    <button type="submit" class="btn btn-success">{{ 'Update Report' if report else 'Add Report' }}</button>
</form>

<script>
function toggleOtherField() {
    var select = document.getElementById('report_reason');
    var otherField = document.getElementById('other_reason');
    if (select.value === 'Other') {
        otherField.classList.remove('d-none');
    } else {
        otherField.classList.add('d-none');
    }
}

// Initialize the visibility of the other field based on the current value
document.addEventListener('DOMContentLoaded', function() {
    toggleOtherField();
});
</script>
{% endblock %}
